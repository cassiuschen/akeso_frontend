define(["jquery","underscore","form","navbar"],function(e,t,a,n){return{init:function(){return n.setActive("production"),this.handleTypeSelect(),window.UI=this,window.totalPrice=0,window.formData={}},handleStep2Init:function(){var t;return t=this,e("#nextToStep2").on("click",function(){var a;return console.log("click!"),"StepTwo"===e("#nextToStep2").data("target")?(console.log("toStepTwo"),e(".step").removeClass("onStepOne"),e(".step").addClass("on"+e("#nextToStep2").data("target")),e("#nextToStep2").data("target","StepOne"),e(this).html('<i class="fa fa-angle-left"> 选择款式'),a=e("#step-1").height(),e("#step-1").hide(),e(this).data("layoutValue",e(".price").data("price")),setTimeout(function(){return e("#step-2").removeClass("hide").fadeIn(600).addClass("show"),t.selectionUI(),e("#sendCode").on("click",function(){return t.sendSMS()})},200)):(e("#step-1").show(),e("#step-2").fadeOut(600).addClass("hide").removeClass("show"),console.log("toStepOne"),e(".step").removeClass("onStepTwo"),e(".step").addClass("on"+e("#nextToStep2").data("target")),e("#nextToStep2").data("target","StepTwo"),e(this).html('填写信息 <i class="fa fa-angle-right">'))})},handleTypeSelect:function(){var t;return t=this,e(".type").on("click",function(a){var n;return e(".type").addClass("mute"),e(".type.selected").removeClass("selected"),e("#nextToStep2").removeAttr("disabled"),e(this).removeClass("mute").addClass("selected"),t.updatePrice(e(this).data("price")),n=e(this).data("type"),window.formData.type=n,e("#nextToStep2").attr("href","/orders/new/"+n)})},selectionUI:function(){var t;return t=this,e(".selections .selection").on("click",function(){var a,n;return e(".selections input").val(e(this).text()),e(".selection.selected").removeClass("selected"),e(this).addClass("selected"),a=Number(e("#nextToStep2").data("layoutValue")),t.updatePrice(a+Number(e(this).data("value"))),n=""+e(".colors .color.selected").data("name")+e(".colors .color.selected").parent().data("typename"),0!==e(this).data("value")?(n+=" + "+e(this).text(),e(".des").addClass("show")):e(".des").removeClass("show"),e(".typeInput").text(n)})},updatePrice:function(t){return window.totalPrice=t,e(".price").data("price",t),e(".price").html("<span>价格</span>￥"+t),e(".price").addClass("priceChange"),setTimeout(function(){return e(".price").removeClass("priceChange")},800)},sendSMS:function(){var t,n,s;return s=this,e("#sendCode").attr("disabled","disabled"),t=e("input#mobile").val(),n={},e.ajax({type:"GET",url:"/leancloud/sendSMS/"+t,params:{mobile:t},data:{mobile:t},contentType:"application/json",dataType:"json",async:!1,success:function(t,o){return n=t,console.log(n.message),200===n.status?(e("#submit").removeAttr("disabled"),e("#submit").on("click",function(){return s.submit()})):a.getWarn("input#mobile","手机号似乎有点问题哦，请重新填写。",function(t){return e("#sendCode").removeAttr("disabled")})}})},getFormData:function(){var t;return t={},t.username=e("input#name").val(),t.smsCode=e("input#code").val(),t.mobilePhoneNumber=e("input#mobile").val(),t.email=e("input#email").val(),t.orders={type:e(".typeInput").data("type"),color:e(".typeInput").data("color"),glass:e("input#glass").val(),province:e("input#province").val()},t},submit:function(){var e;return e=this,console.log(this.getFormData())}}});