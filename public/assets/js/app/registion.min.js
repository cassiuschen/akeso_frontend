define(["jquery","underscore","cookie","navbar","leancloud","form","modal"],function(e,t,s,i,n,o,a){e("body").addClass("users registion");try{i.setActive("users")}catch(r){}return window.CC=s,o.actionBtn({selector:"#sendCode",loadingText:"已发送",onclick:function(t){var s;return s=e("input#mobile").val(),console.log(s),n.checkIfExist(s)?(e(this.selector).text("已发送"),n.SMSVerifySend(s,{template:"registion",username:e("input#name").val()}),e("#nextMove").removeAttr("disabled")):o.getWarn("input#mobile","哎呀，这次内测没有入选呢，下回再来试试吧！",function(t){return e("#sendCode").removeAttr("disabled")})}}),e("#nextMove").on("click",function(){var i,r,c;return e("#nextMove").text("请稍后..."),c=n.createUserByMobile(e("input#mobile").val(),e("input#code").val()),console.log(t.has(c,"code")),t.has(c,"objectId")?(i=n.getUserAttendanceDataByMobile(e("input#mobile").val()),r={username:i.name,email:i.email,job:i.job,gender:i.gender,age:i.age,illness:i.illness},s.session("user_session",c.sessionToken),s.session("user_id",c.objectId),n.updateUserData(c.objectId,s.session("user_session"),r)?(e("#step1 .actions").css("opacity","0").remove(),e("#step1 .input-group").css("opacity","0").remove(),e(".sub-title").css("opacity","0"),e("#step1").css("margin-top","-60px"),e("#step2").fadeIn(700),e("#t1").css("opacity","0").text("订单信息").delay(500,function(){return e(this).css("opacity","1")}),e("input#mobile").attr("disabled","disabled"),a.init(),e(".selections .selection").on("click",function(){return e("#typePreviewImg").hasClass("show")||(e("#typePreviewImg").addClass("show"),e("#forming").css("left","-170px")),e("#typePreviewImg img").attr("src","/assets/images/type-"+e(this).data("type")+".jpg"),e("#submit").removeAttr("disabled"),e(".selections input").val(e(this).text()),e(".selection.selected").removeClass("selected"),e(this).addClass("selected")}),e("#submit").on("click",function(){return e("#nameCheck").text(e("input#name").val()),e("#mobileCheck").text(e("input#mobile").val()),e("#addressCheck").text(e("#address").val()),e("#typeImg").attr("src","/assets/images/type-"+e(".selection.selected").data("type")+".jpg"),e("#typeCheck").text(e("input#type").val())}),e("#confirmed").on("click",function(){return e("#confirmed").attr("disabled","disabled"),e(this).text("请稍后..."),r={type:e("input#type").val(),address:e("#address").val()},n.updateUserData(s.session("user_id"),s.session("user_session"),r)?window.location="/users/registion-success.html":void 0})):void 0):(o.getWarn("input#code","验证码错误，请重新输入！",function(e){return console.log("reload")}),e("#nextMove").text("下一步"))})});