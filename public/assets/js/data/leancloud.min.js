define(["jquery","underscore"],function(e,t){return{API_BASE_URL:"https://leancloud.cn/1.1",APP_ID:"Cpt7lNSjHVOCP1DvYNT73ky9",APP_KEY:"AbTX5HRGkOry6rwBdG59lfkd",_makeReq:function(n){var s,r,a;return null==n&&(n={method:"GET",headers:{}}),a={},"GET"!==n.method&&(n.data=JSON.stringify(n.data)),r={"X-LC-Id":this.APP_ID,"X-LC-Key":this.APP_KEY},s=t.extend(r,n.headers),e.ajax({type:n.method,url:this.API_BASE_URL+"/"+n.url,params:n.params,data:n.data,contentType:"application/json",dataType:"json",async:!1,success:function(e,t){return a=e},headers:s}),console.log(a),a},checkIfExist:function(e){var t;return console.log("FUCK!"),t=this._makeReq({method:"GET",url:"classes/Attendances",data:{where:{mobile:e}}}),console.log(t),t.results.length>0?!0:!1},updateInfo:function(e,t){var n,s,r;return null==t&&(t={}),n=this._makeReq({method:"GET",url:"classes/Attendances",data:{where:{mobile:e}}}),n.results.length>0?(s=n.results[0].objectId,r=this._makeReq({method:"PUT",url:"classes/Attendances/"+s,data:t})):!1},SMSVerifySend:function(e,n){var s;return null==n&&(n={}),s={mobilePhoneNumber:e},s=t.extend(s,n),this._makeReq({method:"POST",url:"requestSmsCode",data:s})},SMSVerifyCheck:function(e,t){return this._makeReq({method:"POST",url:"verifySmsCode/"+t+"?mobilePhoneNumber="+e})},createUserByMobile:function(e,t){return this._makeReq({method:"POST",url:"usersByMobilePhone",data:{mobilePhoneNumber:e,smsCode:t}})},getUserAttendanceDataByMobile:function(e){var t,n,s;return t=this._makeReq({method:"GET",url:"classes/Attendances",data:{where:{mobile:e}}}),t.results.length>0?(n=t.results[0].objectId,s=this._makeReq({method:"GET",url:"classes/Attendances/"+n})):{}},updateUserData:function(e,t,n){return this._makeReq({method:"PUT",url:"users/"+e,data:n,headers:{"X-LC-Session":t}})},getUserThatHaveNotSignIn:function(){var e,n,s,r,a;return e=this.attendances(),n=t.map(e,function(e){return e.mobile}),a=this._makeReq({method:"GET",url:"users"}),r=t.map(a.results,function(e){return e.mobilePhoneNumber}),window._=t,s=t.difference(n,r),t.filter(e,function(e){return t.contains(s,e.mobile)})},sendNoticeToUserWhoHaveNotSignIn:function(){var e,t,n,s,r;for(r=this.getUserThatHaveNotSignIn(),n=[],e=0,t=r.length;t>e;e++)s=r[e],n.push(this.SMSVerifySend(s.mobile,{template:"notice-email",name:s.name}));return n},attendances:function(){var e,t;return e=this._makeReq({method:"GET",url:"classes/Attendances"}),t=this._makeReq({method:"GET",url:"classes/Attendances?skip=100"}),e.results.concat(t.results)}}});